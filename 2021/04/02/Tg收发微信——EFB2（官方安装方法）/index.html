<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favion.svg"><link rel="icon" href="/img/favion.svg"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Specialhua"><meta name="keywords" content="学习,编程,想法"><meta name="description" content="一些话终究还是要感谢开发、维护的作者、贡献者：Eana Hufwe 很高兴自己的文章能够上 Google 搜索的前几名~请留意本文末的“最后编辑时间”，如无意外，截至编辑日时 EFB 项目依然能稳定运行。我会时不时更新一些内容，以便教程能够更清晰、更详细。如果有朋友联系我遇到了什么问题，是如何解决的，我尽量会更新到 6.3 一些我遇到的问题、报错 的内容里，以便后来者能够参考。 我习惯于先写作用，"><meta property="og:type" content="article"><meta property="og:title" content="Tg收发微信——EFB2（官方安装方法）"><meta property="og:url" content="https://inkcodes.com/2021/04/02/Tg%E6%94%B6%E5%8F%91%E5%BE%AE%E4%BF%A1%E2%80%94%E2%80%94EFB2%EF%BC%88%E5%AE%98%E6%96%B9%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95%EF%BC%89/index.html"><meta property="og:site_name" content="InkCodes"><meta property="og:description" content="一些话终究还是要感谢开发、维护的作者、贡献者：Eana Hufwe 很高兴自己的文章能够上 Google 搜索的前几名~请留意本文末的“最后编辑时间”，如无意外，截至编辑日时 EFB 项目依然能稳定运行。我会时不时更新一些内容，以便教程能够更清晰、更详细。如果有朋友联系我遇到了什么问题，是如何解决的，我尽量会更新到 6.3 一些我遇到的问题、报错 的内容里，以便后来者能够参考。 我习惯于先写作用，"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.specialhua.top/hexo_img/wallhaven-x6pd8z.webp"><meta property="article:published_time" content="2021-04-01T16:11:07.000Z"><meta property="article:modified_time" content="2024-11-13T16:11:37.000Z"><meta property="article:author" content="Specialhua"><meta property="article:tag" content="wechat"><meta property="article:tag" content="EFB"><meta property="article:tag" content="bot"><meta property="article:tag" content="TG"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://cdn.specialhua.top/hexo_img/wallhaven-x6pd8z.webp"><title>Tg收发微信——EFB2（官方安装方法） - InkCodes</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/custom.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"inkcodes.com",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:40,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!0,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><img src="/img/InkCodes-02.png" alt="InkCodes" class="navbar-logo"> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/talks/" target="_self"><i class="iconfont icon-slack-fill"></i> <span>碎语</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(https://cdn.specialhua.top/hexo_img/wallhaven-x6pd8z.webp) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="Tg收发微信——EFB2（官方安装方法）"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-04-02 00:11" pubdate>2021年4月2日 凌晨</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 6k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 51 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">Tg收发微信——EFB2（官方安装方法）</h1><div class="markdown-body"><h3 id="一些话"><a href="#一些话" class="headerlink" title="一些话"></a>一些话</h3><p>终究还是要感谢开发、维护的作者、贡献者：<br>Eana Hufwe<br><img src="https://cdn.specialhua.top/blog/2022-03-16-respect.jpeg-pic" srcset="/img/loading.gif" lazyload alt="respect!!!"></p><p><strong>很高兴自己的文章能够上 Google 搜索的前几名~请留意本文末的“最后编辑时间”，如无意外，截至编辑日时 EFB 项目依然能稳定运行。我会时不时更新一些内容，以便教程能够更清晰、更详细。如果有朋友联系我遇到了什么问题，是如何解决的，我尽量会更新到 <code>6.3 一些我遇到的问题、报错</code> 的内容里，以便后来者能够参考。</strong></p><p>我习惯于先写作用，优缺点，再写相关教程，方便你快速地了解，并决定到底搭不搭建。<br>另外，我讨厌微信，<strong>小而美</strong>，<strong>拉近人与人的距离</strong>，——这些，跟它都毫不搭边，我们太多人被裹挟着使用了它，如果有一天微信不再是应用市场“必装软件”，那该多好啊。。。我所需要的，不过是想念某个朋友的时候，能跟他聊上两句就够了，我不需要那么多的工作群、朋友群、炫耀&#x2F;广告圈。。。</p><p>我常说，我们都是 Wechat OS 的逃离者，很怀念那个只能一条打几十字的短信年代，它给了我们很多思考的时间、措辞的时间、想念的时间。<br>——而这些，我们终究是没法再踏进历史的河流了。</p><h3 id="1-关于以前写的一篇"><a href="#1-关于以前写的一篇" class="headerlink" title="1.关于以前写的一篇"></a>1.关于以前写的一篇</h3><p>上一篇文章：<a target="_blank" rel="noopener" href="https://specialhua.top/20190910/cid=8.html">利用 Telegram 收发微信——EFB2.0</a> 中使用的是 Docker 方法安装，其实也没有多么的方便，而且由于今晚帮一位哥们安装，走 docker 安了一遍到最后报错如下</p><p><img src="https://cdn.specialhua.top/picgo/%E8%80%81%E6%96%B9%E6%B3%95%E6%8A%A5%E9%94%99.png#mirages-width=619&mirages-height=103&mirages-cdn-type=1" srcset="/img/loading.gif" lazyload alt="老方法报错"></p><p>前面一堆报错，最后关键是：</p><blockquote><p>“catbaron.sticker2img”is not foung</p></blockquote><p>搜索后，解决方案也有，戳这：<a href="%5BGitHub%20-%20catbaron0/efb-sticker2img-middleware:%20Convert%20stickers%20to%20image%5D(https://github.com/catbaron0/efb-sticker2img-middleware)">Sticker2Img: A middleware for EFB</a>，但是前一篇采用 docker 方式安装后，再进行上面 github 里的操作仍然不行。于是干脆直接找相关官方文档来看，毕竟也好长时间没折腾了。其实整个过程意外的简单，而且后续更新升级也容易。</p><p>一些简介性内容就直接搬以前的了。优点和缺点我会讲的更详细一些。</p><h3 id="2-简介"><a href="#2-简介" class="headerlink" title="2.简介"></a>2.简介</h3><p>简单来说，收发原理是：<br><strong>Tg 端消息——Telegram bot —— EFB ——微信网页版 ≈ 微信——微信消息</strong><br>TG 与微信之间并无联系，但使用了 <em>EFB 项目（2.1）</em>，<em>TG Bot（2.2）</em>，<em>微信网页版（2.3）</em>，即可实现互通</p><p>有关更详细的工作原理，请查看 <a target="_blank" rel="noopener" href="https://ehforwarderbot.readthedocs.io/zh_CN/latest/guide/walkthrough.html" title="原理">EFB 工作原理</a>。</p><h4 id="2-1-EH-Forwarder-Bot（EFB）"><a href="#2-1-EH-Forwarder-Bot（EFB）" class="headerlink" title="2.1 EH Forwarder Bot（EFB）"></a>2.1 EH Forwarder Bot（EFB）</h4><p>EH Forwarder Bot（EFB） 是一个可扩展的开源聊天平台隧道 Bot 框架，目前支持在 Telegram 上收发微信、QQ、Facebook Message 信息，支持文字、语音、图片、视频、表情互通，虽有一些功能限制但可用性良好。</p><h4 id="2-2-TG-Bot"><a href="#2-2-TG-Bot" class="headerlink" title="2.2 TG Bot"></a>2.2 TG Bot</h4><p>你可以把 Telegram bot 理解为 QQ 群中某些机器人，在群聊中他能实现入群审核、自动回复等，只不过我们要自己创建机器人，并赋予它一些配合 EFB 使用的指令，就可以使用啦（很简单，不信你往下看）。<br>我们要做的就是创建 Bot，并把他绑定到 Telegram 自建的各种群组中，比如以对方名称（私人）、以微信群名、以公众号名建立的群组，EFB 负责不停的把这些消息通过 Telegram 群组 id 和微信对话作一一绑定，并收发信息展现在 Telegram 群组中。</p><h4 id="2-3-微信网页版"><a href="#2-3-微信网页版" class="headerlink" title="2.3 微信网页版"></a>2.3 微信网页版</h4><p>由于手机 APP 及 PC 桌面版的大量使用，现在已经很少有人使用网页版了<br>本项目需要调用微信网页版。</p><p>[tip type&#x3D;”error” title&#x3D;”警告如下！警告如下！警告如下！（重要的事说三遍！）”]</p><p>微信会对使用第三方客户端登录微信网页版的用户实行封禁，就是无法再使用网页版登录网页版微信！根据经验微信账号较老的用户封禁率似乎不高。</p><p>[&#x2F;tip]</p><p>PS：我的微信号大概是 2013 年创建的，目前使用 EFB 近四年无封禁</p><hr><p>使用或考虑购买 VPS 以前，首先尝试登录<a target="_blank" rel="noopener" href="https://wx.qq.com/">微信网页版</a>，扫码看是否会出现以下提示：</p><p><img src="https://cdn.specialhua.top/picgo/20210401230727.png#mirages-width=2143&mirages-height=364&mirages-cdn-type=1" srcset="/img/loading.gif" lazyload alt="网页封禁"></p><p>否则 ，当你买好 VPS，弄了半天，到最后终于扫码成功时出现以下提示，直接 GG（这也是我帮老哥鼓捣，自己最后折腾了好几次基础环境后，封禁提示才看到）</p><p><img src="https://cdn.specialhua.top/picgo/20210401231143.png#mirages-width=907&mirages-height=301&mirages-cdn-type=1" srcset="/img/loading.gif" lazyload alt="最后封禁"></p><hr><p>因此，网页版微信不同于 windows、mac、android 平板，如网页版被封禁，请默默关掉本页，并说一句：<strong>张小龙，sm 玩意儿</strong></p><h5 id="2021-12-26-解封方法"><a href="#2021-12-26-解封方法" class="headerlink" title="2021-12-26 解封方法"></a>2021-12-26 解封方法</h5><p><del>此方法预计将急速失效</del>。（此方法自 2022 年初就已失效，贴在这里看以后会不会生效吧）<br>微信网页版解封方法：<br>先用新上线的网页版文件传输助手 <a target="_blank" rel="noopener" href="https://filehelper.weixin.qq.com/">https://filehelper.weixin.qq.com/</a> 随便传个文件。<br>再去登录 <a target="_blank" rel="noopener" href="https://wx.qq.com/">https://wx.qq.com/</a> 就会发现微信网页版可以正常登录了。<br>亲测有效，之前登不上微信网页版要抓住这次机会。</p><p>消息来源：<br><a target="_blank" rel="noopener" href="https://hostloc.com/thread-946732-1-2.html">https://hostloc.com/thread-946732-1-2.html</a></p><hr><h3 id="3-EFB-能实现的功能、优点、缺点"><a href="#3-EFB-能实现的功能、优点、缺点" class="headerlink" title="3.EFB 能实现的功能、优点、缺点"></a>3.EFB 能实现的功能、优点、缺点</h3><p>综合考虑微信的功能，对比 EFB 项目，其功能及优缺点如下：</p><h4 id="3-1-基础功能"><a href="#3-1-基础功能" class="headerlink" title="3.1 基础功能"></a>3.1 基础功能</h4><p>1.<strong>文字消息的收发</strong><br>2.<strong>图片的收发</strong><br>3.<strong>视频的读取（从 tg 发视频，对方收到的是文件）</strong><br>4.<strong>语音的接收（从 tg 发语音，对方收到的是文件）</strong><br>5.<strong>传送文件（大于 200M 文件未尝试过）</strong></p><h4 id="3-2-优点"><a href="#3-2-优点" class="headerlink" title="3.2 优点"></a>3.2 优点</h4><p>1.<strong>消息云同步，文字，语音，图片，视频，发送的链接，文件都可以永久保存在 tg 云端，这个，可是好的太多！太多！！太多！！！了，以微信的尿性，不占用你 10 个 G 内存说不过去。任何时候你都可以去翻翻某个群、某个好友以前给你发过的东西。（前女友&#x2F;男友在哪天几点几分伤你心都可以拿出来算旧账@(你懂的)）</strong></p><p>同时，相关信息是被标签所分类的。</p><p><strong>对于查找文件——超级方便，即便你没在微信客户端保存，都会被记录</strong></p><p><strong>对于微信 OS 动不动就图片已失效——完美复刻，再也不怕领导发给你的图片式工作安排丢了 ，高清大图你值得拥有。</strong></p><p><strong>对于历史链接——提供预览，再也不用面对看不懂的域名，摸不着头脑。</strong></p><p><strong>对于 GIFs——搞笑表情包是谁发的，立马就能定位。</strong></p><p><img src="https://cdn.specialhua.top/blog/2022-03-17-20210401233912.png-pic#pic_left" srcset="/img/loading.gif" lazyload alt="消息云端"></p><p>2.<strong>消息几乎无延迟，对比 Gcmformojo<del>（一款曾经代替微信&#x2F;qq OS 的应用，已成历史）</del>，tg 发消息很快，没有卡顿，就像你正常聊天一样，也几乎没有消息发送失败的情况（除非网络抽风，服务器被打&#x2F;被墙）。</strong></p><p>3.<strong>耗电，明显优于微信毒瘤。tg 自带 Gcm&#x2F;IOS 同样支持消息推送，如果你需要，可以不留 tg 后台，由 Gcm&#x2F;IOS push 拉起通知。</strong></p><p>4.<strong>无需强制要求挂梯，以往 Gcmformojo 有的地区需要挂飞机才能收发，而 tg 自带一个代理功能，正常使用 TG 即可通过其内嵌代理收发微信。</strong></p><p>5.<strong>TG 支持的消息功能，将会“镜像”的同步于微信，比如延迟、定时发送消息的功能。</strong></p><p><img src="https://cdn.specialhua.top/blog/2022-03-17-20210401232305.png-pic" srcset="/img/loading.gif" lazyload alt="定时发送"></p><p>6.<strong>tg 表情包支持，另外注意不要发送涉黄、政治敏感的表情包，避免被微信屏蔽或封禁</strong></p><p><img src="https://cdn.specialhua.top/blog/2022-03-17-20210401232442.png-pic" srcset="/img/loading.gif" lazyload alt="贴纸"></p><p>7.<strong>公众号信息也能推送，而且 TG 自带应用内浏览器，也能方便的查看公众号推送的文章。支持批量绑定公众号至某一个群组，并设为静音，支持单设某一个或几个公众号的群组进行单独推送。</strong></p><p>8.<strong>多客户端支持，tg 支持很多客户端，如 mac os、ios、andorid、windows、linux，你完全可以用于取代微信各种版本。而且，tg 轻量且速度快。</strong></p><p>9.<strong>分组功能，比如工作群可以全部收到 TG 的文件夹功能下，通过不同选项标签直接展示所有工作群消息。</strong></p><p>10.<strong>聚合聊天，emmm @(勉强)如果你经常水在各种 tg 群、Tg 频道、新闻、科普、资源等等，要转发个什么东西给微信的好朋友看，随手即可转达。</strong></p><p>11.<strong>消息静音设置，这可太方便了，某些特别吵的群，直接不通知，而某些群，需要午休的时候为了避免打扰到自己， 可以选择 tg 的“暂时屏蔽通知”功能，比微信简单粗暴的通知或不通知好太多了。</strong></p><p><img src="https://cdn.specialhua.top/blog/2022-03-17-20210401233959.png-pic" srcset="/img/loading.gif" lazyload alt="自定义通知"></p><p>12.<strong>硬核物理多开。微信的多开更多的仅限于移动端 +pc 端，或者你用自签名的方式在一台设备上多开 N 个微信账号，对于同一个账号，tg 是支持同账号多设备的，这意味着你可以在多个设备上同时登录同一个 tg 账号，然后不同设备都可以向微信端发送消息。双持，三持，N 持的兄弟就很舒服了。举个例子，你主设备是 ios，同时装 tg 和微信。微信用来刷刷朋友圈，备用机是一台安卓，只装一个 tg，偶尔拿着外出也能收发微信。</strong></p><p>13.<strong>相关中间件支持，例如在 Telegram 上实现语音转文字、Telegram 历史消息搜索、表情包插件等。</strong></p><p>14.<strong>“买一送一”的 Bug 功能——防撤回，以及撤回自己的消息（同样受限于 2min），呃，你的领导深夜喝醉在大群里给老婆发的文字、语音、照片啥的，呃。。。你可以顺手转发到自己的收藏里。。。</strong></p><p>15.<strong>Bug 级“微信”换皮，新春限定？VVIP？NO…你只是逃离了微信 OS 而已。使用 4 年下来，被问的最多的便是“你这什么骚版本的微信？怎么跟我的不一样”，你要说装 B 吧，也是，更多的， TG 支持太多的外观，挺赏心悦目的。</strong></p><h4 id="3-3-缺点"><a href="#3-3-缺点" class="headerlink" title="3.3 缺点"></a>3.3 缺点</h4><p>1.语音通话、视频通话不支持，原因比较简单，微信利用自身 APP 实现，当然不能放到 TG 上实现，但是 TG 会发送一段文字，如：</p><blockquote><p>微信团队: (不支持)<br>[Unsupported message, please check your phone.]</p></blockquote><p>接收到这样的信息请及时打开手机微信查看是否有通话消息，有时还是会遗漏语音通话消息的。</p><p>2.默认所有消息会通过你创建的 TG bot 发送给你，也就是你的好友 A,B,C 的消息都通过一个聊天窗口发送给你，刚开始会比较乱，但是通过 TG 的群组功能，可实现消息分流，但需要你手动创建群组 A，群组 B，群组 C 来分流消息。</p><p>3.对方发来的定位信息能显示具体的地址和地图简略信息，但因为我国地图算法的加密，google 显示的当然不准确。</p><p>4.朋友圈、视频号、游戏——不支持，这年头，正经人谁看广告圈，谁在朋友圈发布自己的负能量，刚好减少自己浪费时间的时光~反倒是优点。</p><p>5.企业微信消息，如果你不把该群迁移到企业微信中，正常推送，没有区别。相反，如果你在企业微信里迁移过该群，则消息不再推送到 Tg。两者兼用的朋友，反倒是优点。</p><hr><h3 id="4-准备工作"><a href="#4-准备工作" class="headerlink" title="4.准备工作"></a>4.准备工作</h3><p>1.一台能访问国外网站的 VPS 服务器，即要连通 Telegram（我目前在用 UFOVPS，稳定，<del>香港双向 cn2 GIA</del>(2021-8-20 在用他家的 香港 BGP，最近他家的 CN2 一直被打)目前支持 国内支付渠道，如果有需要的可以用：**<a target="_blank" rel="noopener" href="https://www.ufovps.com/aff.php?aff=435">我的推广链注册</a>**）（它是为了吸引用户，通过分享注册链的方式，如果你用我的链注册并充值 10 元以上，使用 30 天不退款，我会有一定佣金。算是对我的支持吧~）</p><p>2.Android 手机搭建需要 Juice ssh 这款软件，如何利用 juicessh 连接服务器在 <code>小白搭建心得(2017Gcmformojo).pdf</code> 文档靠前部分（使用公钥连接，目前 android 相关 ssh 软件应很多，这里仅供参考）</p><table><thead><tr><th>名称</th><th>下载地址</th><th>密码</th></tr></thead><tbody><tr><td>小白心得.pdf</td><td><a target="_blank" rel="noopener" href="https://pan.specialhua.top/s/aXc8">https://pan.specialhua.top/s/aXc8</a><br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1E2BvTKdGej0lSlkEwNHO_g">https://pan.baidu.com/s/1E2BvTKdGej0lSlkEwNHO_g</a></td><td>6666<br>sm1p</td></tr><tr><td>juicessh.apk</td><td><a target="_blank" rel="noopener" href="https://pan.specialhua.top/s/LWUq">https://pan.specialhua.top/s/LWUq</a><br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1bCGWe6">https://pan.baidu.com/s/1bCGWe6</a></td><td>6666<br>xhg2</td></tr></tbody></table><p>3.IOS 搭建，app store 搜索 Termius，免费就够用。</p><p>4.windows 搭建需要 xshell 或 putty 等，请自行上网搜索。</p><p>5.Telegram，主体软件。Android play store 或 apkpure 或 IOS app store（非国区账号）</p><p>6.系统使用 Ubuntu 20.04 x64</p><h3 id="5-主体教程"><a href="#5-主体教程" class="headerlink" title="5.主体教程"></a>5.主体教程</h3><p><strong>对于在 ssh 客户端中执行的 linux 代码，有些我会用形如 <code>sudo su</code> 这样的格式来表达（夹穿插在文字叙述部分），而为了保证美观，大部分代码（在换行后，或者说独立于文字叙述的）我会使用下面第一种“引用”样式。</strong><br><strong>而需要在 nano、vim 等编辑界面编辑的内容，我会使用下面第二种“代码框”样式来示范需要填写的内容。</strong></p><blockquote><p><code>hello word!</code><br><code>这里并没有1，2，3，4的行号，是一句一句执行的代码</code></p></blockquote><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">hello <span class="hljs-built_in">word</span>!<br>这里有<span class="hljs-number">1</span>，<span class="hljs-number">2</span>，<span class="hljs-number">3</span>，<span class="hljs-number">4</span>的行号<br></code></pre></td></tr></table></figure><p>参考的文档：</p><p><a target="_blank" rel="noopener" href="https://ehforwarderbot.readthedocs.io/en/latest/">官方文档</a></p><p><a target="_blank" rel="noopener" href="https://blog.shzxm.com/2020/12/31/efb/">ehForwarderBot 遇到的那些坑</a>，作者的<a target="_blank" rel="noopener" href="https://blog.shzxm.com/">博客</a>，感谢这位大佬，很详细了，<strong>安装过程几乎都是搬运的他的，在他的原文里还指出了大量官方插件等文档。</strong></p><hr><h4 id="5-1-配置-TG-机器人阶段"><a href="#5-1-配置-TG-机器人阶段" class="headerlink" title="5.1 配置 TG 机器人阶段"></a>5.1 配置 TG 机器人阶段</h4><h5 id="5-1-1-获取-Bot-Token"><a href="#5-1-1-获取-Bot-Token" class="headerlink" title="5.1.1 获取 Bot Token"></a>5.1.1 获取 Bot Token</h5><p>1.在 Telegram 里, 对 @botfather 说话: &#x2F;newbot<br>2.按照要求给 Bot 取名<br>3.获取 Bot Token 安全原因: Token 必须保密（这串 token 要记好，<strong>待会要用</strong>）<br>4.允许 Bot 读取非指令信息，对 @botfather 说话: &#x2F;setprivacy, 选择 disable<br>5.允许将 Bot 添加进群组，对 @botfather 说话: &#x2F;setjoingroups, 选择 enable<br>6.允许 Bot 提供指令列表，对 @botfather 说话: &#x2F;setcommands, 输入以下内容</p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs erlang">help - 显示命令列表.<br>link - 将远程会话绑定到 Telegram 群组<br>chat - 生成会话头<br>recog - 回复语音消息以进行识别<br>info - 显示当前 Telegram 聊天的信息.<br>unlink_all - 将所有远程会话从 Telegram 群组解绑.<br>update_info - 更新群组名称和头像<br>extra - 获取更多功能<br></code></pre></td></tr></table></figure><p>(复制以上内容一次性发给 botfather)</p><h5 id="5-1-2-获取-Telegram-账户-ID"><a href="#5-1-2-获取-Telegram-账户-ID" class="headerlink" title="5.1.2 获取 Telegram 账户 ID"></a>5.1.2 获取 Telegram 账户 ID</h5><p>再和另外一个机器人 @get_id_bot 对话（也是搜索得到这个机器人），点击 start 即可获得你的 Telegram ID，一串数字（Chat ID）。</p><p>至此，Telegram 的配置完成，我们得到两个重要东西：<strong>token、Telegram ID</strong>（<strong>待会要用</strong>）</p><p>形如：</p><blockquote><p>token——123456789:ABCDEFG1ABCDEFG1ABCDEFG1</p><p>Telegram ID——987654321</p></blockquote><h4 id="5-2VPS-搭建"><a href="#5-2VPS-搭建" class="headerlink" title="5.2VPS 搭建"></a>5.2VPS 搭建</h4><h5 id="5-2-1-依赖环境安装"><a href="#5-2-1-依赖环境安装" class="headerlink" title="5.2.1 依赖环境安装"></a>5.2.1 依赖环境安装</h5><blockquote><p><code>sudo su</code><br><code>apt full-upgrade -y</code><br><code>apt install python3 python3-pip python3-setuptools python3-yaml ffmpeg libcairo2-dev libcairo2 nano -y</code><br><code>python3 -m pip install --upgrade pip</code><br><code>python3 -m pip install --upgrade Pillow</code></p></blockquote><h5 id="5-2-2-安装-efb-主体"><a href="#5-2-2-安装-efb-主体" class="headerlink" title="5.2.2 安装 efb 主体"></a>5.2.2 安装 efb 主体</h5><blockquote><p><code>pip3 install ehforwarderbot</code><br><code>pip3 install efb-telegram-master</code><br><code>pip3 install efb-wechat-slave</code><br><code>pip3 install --upgrade Pillow</code></p></blockquote><h5 id="5-2-3-贴纸插件"><a href="#5-2-3-贴纸插件" class="headerlink" title="5.2.3 贴纸插件"></a>5.2.3 贴纸插件</h5><p>确保你安装成功 libcairo2，把 tg 的贴纸发送到微信</p><blockquote><p><code>pip3 install &quot;efb-telegram-master[tgs]&quot;</code></p></blockquote><h4 id="5-3-配置文件"><a href="#5-3-配置文件" class="headerlink" title="5.3 配置文件"></a>5.3 配置文件</h4><p><code>mkdir</code> 是新建文件夹语法，nano 保存退出是<kbd>ctrl</kbd>+<kbd>x</kbd></p><p>根目录下：</p><blockquote><p><code>mkdir -p /root/.ehforwarderbot/profiles/default/</code></p></blockquote><blockquote><p><code>mkdir -p /root/.ehforwarderbot/profiles/default/blueset.telegram</code></p></blockquote><h5 id="5-3-1-配置-default-config-yaml"><a href="#5-3-1-配置-default-config-yaml" class="headerlink" title="5.3.1 配置 default&#x2F;config.yaml"></a>5.3.1 配置 default&#x2F;config.yaml</h5><p>上面第一行代码，创建了 <code>~default/</code> 目录，还是在根目录下，使用 nano 编辑并粘贴以下内容：</p><blockquote><p><code>nano /root/.ehforwarderbot/profiles/default/config.yaml</code></p></blockquote><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">master_channel</span><span class="hljs-punctuation">:</span> <span class="hljs-string">blueset.telegram</span><br><span class="hljs-attribute">slave_channels</span><span class="hljs-punctuation">:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">blueset.wechat</span><br><span class="hljs-attribute">flags</span><span class="hljs-punctuation">: </span><br>  <span class="hljs-attribute">delete_on_edit</span><span class="hljs-punctuation">:</span> <span class="hljs-string">true</span><br></code></pre></td></tr></table></figure><p><strong>（注意格式！有的手机 juichssh 粘贴进去以后并不会分段，或首字母缺失）</strong></p><h5 id="5-3-2-配置-default-blueset-telegram-config-yaml"><a href="#5-3-2-配置-default-blueset-telegram-config-yaml" class="headerlink" title="5.3.2 配置 default&#x2F;blueset.telegram&#x2F;config.yaml"></a>5.3.2 配置 default&#x2F;blueset.telegram&#x2F;config.yaml</h5><p>上面第二行代码，创建了 <code>~blueset.telegram</code> 目录，还是在根目录下使用 nano 编辑、替换自己的 <code>token</code>,<code>telegram id</code> 粘贴以下内容：</p><blockquote><p><code>nano /root/.ehforwarderbot/profiles/default/blueset.telegram/config.yaml</code></p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">token:</span> <span class="hljs-string">&quot;&quot;</span> <span class="hljs-comment">#在&quot;&quot;中间 填入你之前找botfather申请的api</span><br><span class="hljs-attr">admins:</span><br><span class="hljs-bullet">-</span> <span class="hljs-number">1234</span> <span class="hljs-comment">#把数字修改为你的个人 telegram id 在上方获取过</span><br><span class="hljs-comment">#- 1279136259 #如果,想要多个账号使用同一个微信,可在这里加入第二个id或者多个id,去掉开头的#</span><br><span class="hljs-attr">flags:</span><br>  <span class="hljs-attr">send_image_as_file:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-comment">#将所有图像消息作为文件发送,以防止主动报文的图像压缩.需要更多的流量,可以开启,改为ture</span><br>  <span class="hljs-attr">animated_stickers:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-comment">#启用对动画贴纸的实验性支持启用对动画贴纸的实验性支持,该依赖已包含在教程依赖</span><br>  <span class="hljs-attr">default_media_prompt:</span> <span class="hljs-string">text</span><br>  <span class="hljs-comment">#图片/视频/文件消息没有标题时的占位符文本.</span><br></code></pre></td></tr></table></figure><p>一个样例：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">token:</span> <span class="hljs-string">&quot;123456789:ABCDEFG1ABCDEFG1ABCDEFG1&quot;</span> <br><span class="hljs-attr">admins:</span><br><span class="hljs-bullet">-</span> <span class="hljs-number">123456789</span><br><span class="hljs-attr">flags:</span><br>  <span class="hljs-attr">send_image_as_file:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">animated_stickers:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">default_media_prompt:</span> <span class="hljs-string">text</span><br></code></pre></td></tr></table></figure><p><strong>（注意格式！有的手机 juichssh 粘贴进去以后并不会分段，注意首字母可能缺失）</strong><br><strong>（<code>send_image_as_file</code> 字段我建议使用 false，不然所有图片文件都将以文件形式呈现，使用 false 的话，除非对方选择以原图发送，否则就是正常的图片）</strong></p><h4 id="5-3-启动"><a href="#5-3-启动" class="headerlink" title="5.3 启动"></a>5.3 启动</h4><p>根目录下：</p><blockquote><p><code>ehforwarderbot</code></p></blockquote><p>此时，扫码要使用手机后置摄像头，截图并在相册里选择二维码的方式会遭遇微信提示不能登录</p><p>如果此时你已成功登录，在你的 xshell 等终端工具关闭以后，EFB 自然掉线，因为没有做进程守护，此时请看下面的 6.3.2 的内容。</p><h3 id="6-使用你的-EFB-机器人"><a href="#6-使用你的-EFB-机器人" class="headerlink" title="6.使用你的 EFB 机器人"></a>6.使用你的 EFB 机器人</h3><h4 id="6-1-简单用起来吧"><a href="#6-1-简单用起来吧" class="headerlink" title="6.1 简单用起来吧"></a>6.1 简单用起来吧</h4><p>此时别关掉你的 ssh 客户端哦，一关掉 efb 进程就被结束了。这部分内容你可以当作成功运行 EFB 后体验一下具体的操作，如果要关掉 ssh 客户端还能继续使用的话，请看 <code>6.2.1 后台</code> 部分。<br>和你之前申请的 bot 对话 发送 <code>/start</code></p><p>其余常用命令：</p><p><code>/chat</code> 为 和谁对话</p><blockquote><p>若是在 Bot 中对方发来消息，在 Telegram 中回复该对话（Android 应为长按该消息，IOS 左滑该消息），可以直接回复给该人。在新版本 EFB 中，回复过该人消息一次，接下来短期内的连续对话，不用每一条都一一“引用”该消息，直接对你的 Bot 对话，所有消息都将发送给该人。</p></blockquote><p><code>/link</code> 为 绑定对话到某个群组</p><blockquote><p>下面使用一个例子来说明（假设你有一名叫李 AB 的好友）</p><ol><li>首先在 Telegram 中创建一个新的群组，就用李 AB 这个名字，然后将你的机器人邀请进来，群组创建完毕。</li><li>回到你的机器人对话中，输入 &#x2F;link 李 A（不必输全名，机器人会检索含有此关键字的所有好友，然后选中李 AB，选择 link，选择你刚刚创建的 梁 AB 这个群组，成功后，以后这个叫李 AB 的好友发来的信息不会在机器人那显示了，而是在这个群组）</li><li>常聊的几个人、工作群、公众号、不常看的公众号单独建 TG 群，使消息分流，其余不常用的，使用机器人窗口接收</li></ol></blockquote><p><code>/rm</code> 为 撤回某条消息，和微信的规则是一样的，2 分钟内都可以。具体使用为回复要撤回的内容并发送 <code>/rm</code><br><code>/extra</code> 主要为掉线重新登录 或者 强制刷新对话列表使用<br><code>/update_info</code> 为当前的群组更新微信信息，在群组中使用，可以更新群聊头像为群组成员，群组名称为微信群聊名称</p><h4 id="6-2-后台、更新"><a href="#6-2-后台、更新" class="headerlink" title="6.2 后台、更新"></a>6.2 后台、更新</h4><h5 id="6-2-1-后台"><a href="#6-2-1-后台" class="headerlink" title="6.2.1 后台"></a>6.2.1 后台</h5><p>进程守护 可以确保 efb 在后台运行</p><blockquote><p><code>cd /etc/systemd/system/</code><br><code>nano efb.service</code></p></blockquote><p>进入编辑界面后 复制粘贴下列代码 <code>ctrl+x</code> 保存退出</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Unit]</span><br><span class="hljs-attr">Description</span>=ehforwarderbot<br><span class="hljs-attr">After</span>=network.target<br><br><span class="hljs-section">[Install]</span><br><span class="hljs-attr">WantedBy</span>=multi-user.target<br><br><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Type</span>=simple<br><span class="hljs-attr">WorkingDirectory</span>=/root<br><span class="hljs-attr">ExecStart</span>=/usr/local/bin/ehforwarderbot<br><span class="hljs-attr">Restart</span>=always<br></code></pre></td></tr></table></figure><p>接着 输入以下代码启动 efb，并开机自启 efb</p><blockquote><p>1.重新加载进程守护<br><code>systemctl daemon-reload</code><br>2.进程守护 启动 efb<br><code>systemctl start efb.service</code><br>3.打印日志，此时不会直接显示二维码，而需要你打开 https 的链接，进行扫码登录<br><code>journalctl -f -u efb.service</code><br>4.进程守护 开机自启 efb<br><code>systemctl enable efb.service</code></p></blockquote><p>另外的，这里我把常用的 <code>systemctl</code> 命令合集放在这里，方便你随时查看。<br>停止、启动、关闭自启、查看状态、打印后台日志，可以使用以下这些代码（这里为保持美观，我只是使用代码框包裹住了这些命令）</p><blockquote><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-comment">#进程守护 停止efb</span><br><span class="hljs-params">system</span>ctl stop efb.service<br><span class="hljs-comment">#进程守护 启动efb</span><br><span class="hljs-params">system</span>ctl start efb.service<br><span class="hljs-comment">#进程守护 关闭开机自启efb</span><br><span class="hljs-params">system</span>ctl disable efb.service<br><span class="hljs-comment">#查看当前 efb 状态</span><br><span class="hljs-params">system</span>ctl status efb.service<br><span class="hljs-comment">#实时查看 efb 守护日志</span><br>journalctl -f -u efb.service<br></code></pre></td></tr></table></figure></blockquote><h5 id="6-2-2-更新"><a href="#6-2-2-更新" class="headerlink" title="6.2.2 更新"></a>6.2.2 更新</h5><blockquote><p><code>pip3 install --upgrade ehforwarderbot</code><br><code>pip3 install --upgrade efb-telegram-master</code><br><code>pip3 install --upgrade efb-wechat-slave</code></p></blockquote><h4 id="6-3-一些我遇到的问题、报错"><a href="#6-3-一些我遇到的问题、报错" class="headerlink" title="6.3 一些我遇到的问题、报错"></a>6.3 一些我遇到的问题、报错</h4><h5 id="6-3-1-Cannot-uninstall-‘PyYAML’"><a href="#6-3-1-Cannot-uninstall-‘PyYAML’" class="headerlink" title="6.3.1 Cannot uninstall ‘PyYAML’"></a>6.3.1 Cannot uninstall ‘PyYAML’</h5><p>在帮别人安装时，<code>ehforwarderbot</code> 后，出现报错如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">root@xxx:~<span class="hljs-comment"># ehforwarderbot</span><br>……省略……<br>Traceback (most recent call last):<br>  File <span class="hljs-string">&quot;/usr/local/bin/ehforwarderbot&quot;</span>, line <span class="hljs-number">8</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<br>    sys.<span class="hljs-keyword">exit</span>(main())<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.6/dist-packages/ehforwarderbot/__main__.py&quot;</span>, line <span class="hljs-number">330</span>, <span class="hljs-keyword">in</span> main<br>    conf = config.load_config()<br>  File <span class="hljs-string">&quot;/usr/local/lib/python3.6/dist-packages/ehforwarderbot/config.py&quot;</span>, line <span class="hljs-number">61</span>, <span class="hljs-keyword">in</span> load_config<br>    raise ValueError(_(<span class="hljs-string">&quot;\&quot;&#123;&#125;\&quot; is not found.&quot;</span>).format(i))<br>ValueError: <span class="hljs-string">&quot;blueset.wechat&quot;</span> is not found.<br></code></pre></td></tr></table></figure><p>最后一句表明主体 <code>efb-wechat-slave</code> 并没有安装好，尝试再次安装</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs subunit">root@xxxxx:~# pip3 install efb-wechat-slave<br>Collecting efb-wechat-slave<br>  Using cached efb_wechat_slave<span class="hljs-string">-2</span>.0.4-py3-none-any.whl (216 kB)<br> 省略``<br>Installing collected packages: PyYaml, itchat, efb-wechat-slave<br>  Attempting uninstall: PyYaml<br>    Found existing installation: PyYAML 3.12<br><span class="hljs-keyword">ERROR: </span>Cannot uninstall &#x27;PyYAML&#x27;. It is a distutils installed project and thus we cannot accurately determine which files belong to it which would lead to only a partial uninstall.<br></code></pre></td></tr></table></figure><p>最后一句红字报错，翻译过来就是，错误：无法卸载“ PyYAML”。 这是一个 distutils 安装的项目，因此我们无法准确确定属于该文件的文件，这只会导致部分卸载。<br>pip 10 不再卸载 distutils 软件包。所以降级到 pip 8.1.1，根目录下：</p><blockquote><p><code>sudo -H pip3 install pip==8.1.1</code></p></blockquote><p>再次安装 efb-wechat-slave，安装代码见 5.2.2 部分。</p><h5 id="6-3-2-simplejson-errors-JSONDecodeError"><a href="#6-3-2-simplejson-errors-JSONDecodeError" class="headerlink" title="6.3.2 simplejson.errors.JSONDecodeError"></a>6.3.2 simplejson.errors.JSONDecodeError</h5><p>在 ehforwarderbot 运行之后，表现为 <code>Initializing slave blueset.wechat...</code> 之后，提示如下：</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-number">2021</span><span class="hljs-number">-04</span><span class="hljs-number">-21</span> <span class="hljs-number">02</span>:<span class="hljs-number">25</span>:<span class="hljs-number">24</span>,<span class="hljs-number">378</span> [Level <span class="hljs-number">99</span>]: ehforwarderbot.__main__ (__main__.init; [*main*.py:<span class="hljs-number">129</span>](main.py:<span class="hljs-number">129</span>))<br> Initializing slave blueset.wechat...<br><span class="hljs-built_in">Traceback</span> (most recent call last):<br><span class="hljs-built_in">File</span> <span class="hljs-string">&quot;/usr/local/bin/ehforwarderbot&quot;</span>, line <span class="hljs-number">8</span>, in &lt;<span class="hljs-keyword">module</span>&gt;<br>sys.<span class="hljs-built_in">exit</span>(<span class="hljs-built_in">main</span>())<br><span class="hljs-built_in">File</span> <span class="hljs-string">&quot;/usr/local/lib/python3.8/dist-packages/ehforwarderbot/__main__.py&quot;</span>, line <span class="hljs-number">339</span>, in main<br>。。。省略。。。<br><span class="hljs-built_in">File</span> <span class="hljs-string">&quot;/usr/lib/python3/dist-packages/simplejson/decoder.py&quot;</span>, line <span class="hljs-number">400</span>, in raw_decode<br><span class="hljs-keyword">return</span> self.<span class="hljs-built_in">scan_once</span>(s, idx=_w(s, idx).<span class="hljs-built_in">end</span>())<br>simplejson.errors.JSONDecodeError: Expecting value: line <span class="hljs-number">1</span> column <span class="hljs-number">1</span> (<span class="hljs-type">char</span> <span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>解决方案：<br>1.使用电脑打开微信网页版，检查你的 Web 网页登录权限是否健在<br>2.重启 vps，重新登录看是否好转<br>3.尝试删除这个文件：</p><blockquote><p>.ehforwarderbot&#x2F;profiles&#x2F;default&#x2F;blueset.wechat&#x2F;wxpy.pkl<br><br>具体为：</p></blockquote><blockquote><p><code>rm -f .ehforwarderbot/profiles/default/blueset.wechat/wxpy.pkl</code></p></blockquote><p>4.使用 <code>kill -9</code> 强制关闭 ehforwarderbot 进程<br>2021 年 12 月 23 日，我的朋友、以及在群里的部分人遭遇了掉线，以及如上报错，使用该方法成功登录</p><p>在使用 <code>systemctl start efb.service</code> 指令后，使用 <code>ps -aux</code> 查看当前所有进程的情况</p><p>你会发现 ehforwarderbot 的 PID 一直在变，于是使用简单的 kill 命令无法正常关闭该进程，使用以下命令（多运行几次），将其结束掉</p><blockquote><p><code>ps aux | grep ehforwarderbot | awk &#39;&#123;print $2&#125;&#39; | xargs kill -9</code></p></blockquote><p>再次使用 <code>ps -aux</code> 查看进程直至 ehforwarderbot 已经被关闭，稍等片刻再尝试登录</p><h5 id="6-3-3-冲突轮询，请确保只有一个实例在运行"><a href="#6-3-3-冲突轮询，请确保只有一个实例在运行" class="headerlink" title="6.3.3 冲突轮询，请确保只有一个实例在运行"></a>6.3.3 冲突轮询，请确保只有一个实例在运行</h5><p>一般是你刚使用 <code>ehforwarderbot</code> 进行登录后，由于你继续使用 <code>systemctl</code> 做进程守护，导致运行了两个实例，只需要确保进程守护已经做好后：<br>1.把 efb 进程停止</p><blockquote><p><code>systemctl stop efb.service</code></p></blockquote><p>2.查看一下 efb 进程是否为 died，而非 running</p><blockquote><p><code>systemctl status efb.service</code></p></blockquote><p>3.使用 <code>systemctl start efb.service</code> 启动 EFB，而不是刚开始搭建完毕时使用的 <code>ehforwarderbot</code>，并用 <code>journalctl -f -u efb.service</code> 来查看后台进程的情况。</p><p>4.如出现二维码 qrcode 的链接，打开或复制到浏览器去扫码登录，如提示正在初始化从端、加载中间件、所有中间件加载完毕等字样，说明已经登录成功了。</p><h5 id="6-3-4-偶尔发现没有消息推送了怎么办？"><a href="#6-3-4-偶尔发现没有消息推送了怎么办？" class="headerlink" title="6.3.4 偶尔发现没有消息推送了怎么办？"></a>6.3.4 偶尔发现没有消息推送了怎么办？</h5><p>虽说 EFB 能保持数月不掉线。<br>但为延长续航，我用空调狗等 APP(Android) 冻结了微信、IOS 不开启消息微信推送，但是手机版微信不能长期不上线，有时候手机关机没电太久，也会导致 EFB 掉线，这时就需要到 VPS 服务器控制端，手动重启服务器，一般就能重连。</p><h3 id="7-EFB-讨论相关"><a href="#7-EFB-讨论相关" class="headerlink" title="7.EFB 讨论相关"></a>7.EFB 讨论相关</h3><p><a target="_blank" rel="noopener" href="https://github.com/ehForwarderBot/ehForwarderBot/discussions">Github Discussions (论坛&#x2F;社区)</a> <em>主要</em> 讨论社区</p><p><a target="_blank" rel="noopener" href="https://t.me/EFBSupport">Telegram 频道</a>群组入口请从此处进入</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E6%8A%80%E6%9C%AF/" class="category-chain-item">技术</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/wechat/" class="print-no-link">#wechat</a> <a href="/tags/EFB/" class="print-no-link">#EFB</a> <a href="/tags/bot/" class="print-no-link">#bot</a> <a href="/tags/TG/" class="print-no-link">#TG</a></div></div><div class="license-box my-3"><div class="license-title"><div>Tg收发微信——EFB2（官方安装方法）</div><div>https://inkcodes.com/2021/04/02/Tg收发微信——EFB2（官方安装方法）/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Specialhua</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2021年4月2日</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2024年11月14日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2021/06/15/%E6%89%80%E6%80%9D%E2%80%94%E2%80%94%E9%BB%84%E5%9B%BD%E5%B9%B3%E8%AE%BA%E6%96%87%E3%80%8A%E8%87%B4%E8%B0%A2%E3%80%8B%E4%B8%BA%E4%BB%80%E4%B9%88%E6%84%9F%E4%BA%BA%E8%87%B3%E6%B7%B1%EF%BC%9F/" title="所思——黄国平论文《致谢》为什么感人至深？"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">所思——黄国平论文《致谢》为什么感人至深？</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2020/10/05/%E6%97%B6%E5%85%89%E6%80%BB%E6%98%AF%E9%82%A3%E4%B9%88%E5%BF%AB%EF%BC%8C%E8%BD%AC%E7%9C%BC%E5%B7%B2%E6%98%AF%E4%B8%80%E5%B9%B4/" title="时光总是那么快，转眼已是一年"><span class="hidden-mobile">时光总是那么快，转眼已是一年</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments"><div id="waline"></div><script type="text/javascript">Fluid.utils.loadComments("#waline",(function(){Fluid.utils.createCssLink("https://registry.npmmirror.com/@waline/client/2.15.8/files/dist/waline.css"),Fluid.utils.createScript("https://registry.npmmirror.com/@waline/client/2.15.8/files/dist/waline.js",(function(){var i=Object.assign({serverURL:"https://comment.xhua.ink",path:"window.location.pathname",meta:["nick","mail","link"],requiredMeta:["nick"],lang:"zh-CN",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],dark:'html[data-user-color-scheme="dark"]',wordLimit:0,pageSize:10},{el:"#waline",path:window.location.pathname});Waline.init(i),Fluid.utils.waitElementVisible("#waline .vcontent",()=>{var i="#waline .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>